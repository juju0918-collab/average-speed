<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¹³å‡é€Ÿç‡ç·´ç¿’</title>
    <style>
        /* ğŸ¨ CSS æ¨£å¼ (èˆ‡å‰æ¬¡æä¾›ä¸€è‡´ï¼Œç•¥éè©³ç´°å…§å®¹) */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f4f7f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }

        header {
            text-align: center;
            color: #1a73e8;
            margin-bottom: 30px;
        }

        main {
            max-width: 900px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background-color: #fcfcfc;
        }

        h2 {
            color: #3c4043;
            border-bottom: 2px solid #e8e8e8;
            padding-bottom: 10px;
            margin-top: 0;
        }

        /* é€²åº¦æŒ‡ç¤ºå™¨æ¨£å¼ */
        #progress-area {
            display: flex;
            justify-content: flex-end; 
            align-items: center;
            background-color: #e3f2fd;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 1.2em;
            font-weight: bold;
            color: #0d47a1;
        }

        /* å°èˆªå€å¡Š */
        #navigation-area {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        
        #start-button {
            background-color: #4CAF50;
            color: white;
            padding: 15px 30px;
            font-size: 1.1em;
            margin-top: 15px;
        }

        #prev-button, #next-button {
            background-color: #2196f3;
            color: white;
        }

        #submit-quiz-button {
            background-color: #f44336;
            color: white;
            margin-left: auto;
        }
        
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        /* æ¸¬é©—è¡¨æ ¼æ¨£å¼ */
        #quiz-table {
            width: 50%; 
            border-collapse: collapse;
            margin: 10px auto 30px auto; 
            font-size: 0.95em;
            table-layout: fixed;
        }

        #quiz-table th, #quiz-table td {
            border: 1px solid #ccc;
            padding: 8px 5px;
            text-align: center;
            vertical-align: middle;
        }
        
        .aux-header-item {
            background-color: #e0e0e0; 
            color: #333;
            font-weight: bold;
            text-align: left;
            width: 30%; 
        }
        
        .aux-header-trip {
            background-color: #f0f0f0;
            color: #1a73e8;
            font-weight: bold;
        }

        /* ç­”æ¡ˆå¡«å¯«å€æ¨£å¼ - å…¬å¼ä½ˆå±€ */
        #answer-input-area {
            background-color: #e6f0ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 25px;
            border: 2px solid #1a73e8;
            display: flex;
            justify-content: space-around;
            align-items: flex-end; 
        }
        
        #answer-input-area > div {
            flex: 1;
            margin: 0 5px;
            text-align: center;
            position: relative;
        }
        
        /* å…¬å¼ç¬¦è™Ÿçš„æ¨£å¼ */
        .formula-symbol {
            font-size: 2.5em;
            font-weight: 300;
            color: #1a73e8;
            margin: 0 10px;
            align-self: center; 
            padding-bottom: 5px;
        }

        #answer-input-area label {
            display: block;
            font-weight: bold;
            color: #1a73e8;
            margin-bottom: 5px;
            font-size: 0.9em; 
        }

        input[type="number"], input[type="text"] {
            width: 90%;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 3px;
            text-align: center;
            font-size: 1em;
        }
        
        .question-text {
            text-align: left;
            font-size: 1.1em;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        /* çµæœå€æ¨£å¼ */
        #result-area {
            text-align: center;
            background-color: #e8f5e9;
            border-color: #4CAF50;
            padding: 30px;
            display: none; 
        }
        
        .name-input-group {
            margin-bottom: 20px;
            text-align: center;
        }
        .name-input-group input {
            width: 50%;
            font-size: 1.2em;
            padding: 8px;
        }
        
        /* ç¸½åˆ†å€åŸŸæ¸…æ™° */
        #final-score {
            font-size: 2.5em;
            color: #4CAF50; 
            font-weight: bold;
            margin-top: 15px;
        }
    </style>
</head>
<body>

    <header>
        <h1>ğŸƒå¹³å‡é€Ÿç‡ç·´ç¿’ğŸƒ</h1>
        <p style="color: #4CAF50; font-weight: bold; margin-top: -15px; margin-bottom: 25px;">å¼µé›¯ç§‹è€å¸«è¨­è¨ˆ</p>
    </header>

    <main>
        
        <section id="progress-area">
            <div id="progress-indicator">è«‹æŒ‰é–‹å§‹æ¸¬é©—</div>
        </section>

        <section id="start-section" style="text-align: center;">
            
            <div class="name-input-group">
                <label for="student-name" style="font-size: 1.2em; font-weight: bold; display: block; margin-bottom: 10px;">è«‹è¼¸å…¥æ‚¨çš„å§“åï¼š</label>
                <input type="text" id="student-name" placeholder="å§“å" required>
            </div>
            
            <button onclick="startQuiz()" id="start-button">é–‹å§‹ç·´ç¿’</button>
        </section>

        <section id="quiz-section" style="display: none;">
            <div id="current-question-text" class="question-text"></div>
            
            
            <table id="quiz-table">
                <thead>
                    <tr>
                        <th class="aux-header-item"></th> 
                        <th class="aux-header-trip">å»ç¨‹</th>
                        <th class="aux-header-trip">å›ç¨‹</th>
                    </tr>
                </thead>
                <tbody id="quiz-body">
                    <tr>
                        <td class="aux-header-item">è·é›¢ (km)</td>
                        <td><input type="number" id="gD-input" min="0" step="0.01"></td> 
                        <td><input type="number" id="bD-input" min="0" step="0.01"></td> 
                    </tr>
                    <tr>
                        <td class="aux-header-item">æ™‚é–“ (hr)</td>
                        <td><input type="number" id="gT-input" min="0" step="0.01"></td> 
                        <td><input type="number" id="bT-input" min="0" step="0.01"></td> 
                    </tr>
                    <tr>
                        <td class="aux-header-item">é€Ÿç‡ (km/hr)</td>
                        <td><input type="number" id="gR-input" min="0" step="0.01"></td> 
                        <td><input type="number" id="bR-input" min="0" step="0.01"></td> 
                    </tr>
                </tbody>
            </table>
            
            <div id="answer-input-area">
                
                <div>
                    <label for="dist-input">ç¸½è·é›¢ (å…¬é‡Œ)</label>
                    <input type="number" id="dist-input" min="0" step="0.01">
                </div>
                
                <div class="formula-symbol">Ã·</div>
                
                <div>
                    <label for="time-input">ç¸½æ™‚é–“ (å°æ™‚)</label>
                    <input type="number" id="time-input" min="0" step="0.01">
                </div>
                
                <div class="formula-symbol">=</div>
                
                <div>
                    <label for="rate-input">å¹³å‡é€Ÿç‡ (å…¬é‡Œ/æ™‚)</label>
                    <input type="number" id="rate-input" min="0" step="0.01">
                </div>
            </div>
            
            <div id="navigation-area">
                <button id="prev-button" onclick="changeQuestion(-1)" disabled>ä¸Šä¸€é¡Œ</button>
                <button id="next-button" onclick="changeQuestion(1)">ä¸‹ä¸€é¡Œ</button>
                <button id="submit-quiz-button" onclick="submitQuiz()" style="display: none;">æäº¤ä¸¦è¨ˆåˆ†</button>
            </div>
        </section>
        
        <section id="result-area">
            <h2>ğŸ‰ ç·´ç¿’çµæœ</h2>
            <p>å­¸ç”Ÿï¼š<strong id="final-name">--</strong></p>
            <p style="display: none;"><strong>ä½œç­”æ™‚é–“ï¼š</strong> <span id="final-time">--</span></p> 
            <p><strong>ç¸½å¾—åˆ† (æ»¿åˆ† 100 åˆ†)ï¼š</strong></p>
            <div id="final-score">0 åˆ†</div>
            
            <button onclick="window.location.reload()" style="margin-top: 20px; background-color: #2196f3;">é‡æ–°ç·´ç¿’</button>
        </section>
    </main>

    <script>
        // ğŸ§  JavaScript é‚è¼¯ï¼šæ•¸æ“šçµæ§‹å’Œæ§åˆ¶é‚è¼¯ 
        const baseQuestions = [
            {
                id: 1, 
                text: "1. å°è¯åƒåŠ å¥è¡Œæ´»å‹•ï¼Œå»ç¨‹12å…¬é‡Œèµ°äº†6å°æ™‚ï¼Œå›ç¨‹ä»¥æ™‚é€Ÿ6å…¬é‡Œèµ°åŸè·¯å›å»ï¼Œè«‹å•å°è¯çš„å¹³å‡é€Ÿåº¦æ˜¯å¤šå°‘ï¼Ÿ",
                ansDist: 24, ansTime: 8, ansRate: 3, 
                auxAns: { gD: 12, gT: 6, gR: 2, bD: 12, bT: 2, bR: 6 }
            },
            {
                id: 2, 
                text: "2. å°è¯åƒåŠ å¥è¡Œæ´»å‹•ï¼Œå»ç¨‹6å…¬é‡Œä»¥æ™‚é€Ÿ2å…¬é‡Œçš„é€Ÿåº¦è¡Œèµ°ï¼Œå›ç¨‹èµ°åŸè·¯èŠ±äº†1å°æ™‚ï¼Œè«‹å•å°è¯çš„å¹³å‡é€Ÿåº¦æ˜¯å¤šå°‘ï¼Ÿ", 
                ansDist: 12, ansTime: 4, ansRate: 3, 
                auxAns: { gD: 6, gT: 3, gR: 2, bD: 6, bT: 1, bR: 6 } 
            },
            {
                id: 3, 
                text: "3. å°è¯åƒåŠ å¥è¡Œæ´»å‹•ï¼Œå»ç¨‹10å…¬é‡Œèµ°äº†6å°æ™‚ï¼Œå›ç¨‹èµ°åŸè·¯èŠ±äº†4å°æ™‚ï¼Œè«‹å•å°è¯çš„å¹³å‡é€Ÿåº¦æ˜¯å¤šå°‘ï¼Ÿ",
                ansDist: 20, ansTime: 10, ansRate: 2, // 20/10 = 2
                auxAns: { gD: 10, gT: 6, gR: 1.6667, bD: 10, bT: 4, bR: 2.5 }
            },
            {
                id: 4, 
                text: "4. å°è¯åƒåŠ å¥è¡Œæ´»å‹•ï¼Œå»ç¨‹ä»¥æ™‚é€Ÿ5å…¬é‡Œèµ°äº†3å°æ™‚ï¼Œå›ç¨‹èµ°åŸè·¯èŠ±äº†2å°æ™‚ã€‚è«‹å•å°è¯çš„å¹³å‡é€Ÿåº¦æ˜¯å¤šå°‘ï¼Ÿ",
                ansDist: 30, ansTime: 5, ansRate: 6, // ç¸½è·é›¢ 30 / ç¸½æ™‚é–“ 5 = 6
                auxAns: { gD: 15, gT: 3, gR: 5, bD: 15, bT: 2, bR: 7.5 }
            },
            {
                id: 5, 
                text: "5. å°è¯åƒåŠ å¥è¡Œæ´»å‹•ï¼Œå»ç¨‹4å…¬é‡ŒèŠ±äº†5å°æ™‚ï¼Œå›ç¨‹ç¹é è·¯èµ°äº†5å…¬é‡Œå»èŠ±äº†4å°æ™‚ï¼Œè«‹å•å°è¯çš„å¹³å‡é€Ÿåº¦æ˜¯å¤šå°‘ï¼Ÿ",
                ansDist: 9, ansTime: 9, ansRate: 1, // ç¸½è·é›¢ 9 / ç¸½æ™‚é–“ 9 = 1
                auxAns: { gD: 4, gT: 5, gR: 0.8, bD: 5, bT: 4, bR: 1.25 }
            },
            {
                id: 6, 
                text: "6. å°è¯åƒåŠ å¥è¡Œæ´»å‹•ï¼Œå»ç¨‹ä»¥æ™‚é€Ÿ5å…¬é‡Œèµ°2å°æ™‚ï¼Œå›ç¨‹èµ°åŸè·¯èŠ±äº†3å°æ™‚ï¼Œè«‹å•å°è¯çš„å¹³å‡é€Ÿç‡æ˜¯å¤šå°‘? ",
                ansDist: 20, ansTime: 5, ansRate: 4, // 20/5 = 4
                auxAns: { gD: 10, gT: 2, gR: 5, bD: 10, bT: 3, bR: 3.33 }
            },
            {
                id: 7, 
                text: "7. å°è¯åƒåŠ å¥è¡Œæ´»å‹•ï¼Œå»ç¨‹ä»¥æ™‚é€Ÿ6å…¬é‡Œèµ°2å°æ™‚ï¼Œå›ç¨‹èµ°åŸè·¯èŠ±äº†4å°æ™‚ï¼Œè«‹å•å°è¯çš„å¹³å‡é€Ÿç‡æ˜¯å¤šå°‘? ",
                ansDist: 24, ansTime: 6, ansRate: 4, 
                auxAns: { gD: 12, gT: 2, gR: 6, bD: 12, bT: 4, bR: 3 }
            },
            {
                id: 8, 
                text: "8. å°è¯åƒåŠ å¥è¡Œæ´»å‹•ï¼Œå»ç¨‹15å…¬é‡Œä»¥æ™‚é€Ÿ3å…¬é‡Œçš„é€Ÿåº¦è¡Œèµ°ï¼Œå›ç¨‹èµ°åŸè·¯èŠ±äº†10å°æ™‚ï¼Œè«‹å•å°è¯çš„å¹³å‡é€Ÿåº¦æ˜¯å¤šå°‘ï¼Ÿ",
                ansDist: 30, ansTime: 15, ansRate: 2, 
                auxAns: { gD: 15, gT: 5, gR: 3, bD: 15, bT: 10, bR: 1.5 }
            }
        ];
        
        let questions = []; 
        let currentQuestionIndex = 0;
        let quizAnswers = []; 
        let studentName = '';
        
        const qTextEl = document.getElementById('current-question-text');
        const startSection = document.getElementById('start-section');
        const quizSection = document.getElementById('quiz-section');
        const resultArea = document.getElementById('result-area');
        const prevBtn = document.getElementById('prev-button');
        const nextBtn = document.getElementById('next-button');
        const submitBtn = document.getElementById('submit-quiz-button');
        const progressEl = document.getElementById('progress-indicator');
        const nameInput = document.getElementById('student-name');
        const finalScoreEl = document.getElementById('final-score'); 

        // Fisher-Yates éš¨æ©Ÿæ’åºç®—æ³•
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        // å•Ÿå‹•æ¸¬é©—
        function startQuiz() {
            studentName = nameInput.value.trim();
            if (!studentName) {
                alert("è«‹å…ˆè¼¸å…¥æ‚¨çš„å§“åï¼");
                return;
            }

            questions = [...baseQuestions]; 
            shuffleArray(questions);
            
            quizAnswers = [];
            questions.forEach(() => {
                quizAnswers.push({});
            });
            
            startSection.style.display = 'none';
            quizSection.style.display = 'block';
            resultArea.style.display = 'none';
            
            currentQuestionIndex = 0;
            loadQuestion(currentQuestionIndex);
        }

        // å„²å­˜ç•¶å‰é¡Œç›®ç­”æ¡ˆ
        function saveCurrentAnswer() {
            const currentQ = questions[currentQuestionIndex];
            
            quizAnswers[currentQuestionIndex] = {
                gD: parseFloat(document.getElementById('gD-input').value) || 0,
                gT: parseFloat(document.getElementById('gT-input').value) || 0,
                gR: parseFloat(document.getElementById('gR-input').value) || 0,
                bD: parseFloat(document.getElementById('bD-input').value) || 0,
                bT: parseFloat(document.getElementById('bT-input').value) || 0,
                bR: parseFloat(document.getElementById('bR-input').value) || 0,
                
                dist: parseFloat(document.getElementById('dist-input').value) || 0,
                time: parseFloat(document.getElementById('time-input').value) || 0,
                rate: parseFloat(document.getElementById('rate-input').value) || 0,
                
                ans: currentQ 
            };
        }

        // è¼‰å…¥æŒ‡å®šé¡Œè™Ÿçš„å•é¡Œ
        function loadQuestion(index) {
            if (index < 0 || index >= questions.length) return;

            const q = questions[index];
            qTextEl.textContent = `${index + 1}. ${q.text.substring(q.text.indexOf('.') + 1)}`;
            
            progressEl.textContent = `ç¬¬ ${index + 1} é¡Œ / å…± ${questions.length} é¡Œ`;

            const savedAns = quizAnswers[index];
            
            document.getElementById('gD-input').value = savedAns.gD || '';
            document.getElementById('gT-input').value = savedAns.gT || '';
            document.getElementById('gR-input').value = savedAns.gR || '';
            document.getElementById('bD-input').value = savedAns.bD || '';
            document.getElementById('bT-input').value = savedAns.bT || '';
            document.getElementById('bR-input').value = savedAns.bR || '';
            
            document.getElementById('dist-input').value = savedAns.dist || '';
            document.getElementById('time-input').value = savedAns.time || '';
            document.getElementById('rate-input').value = savedAns.rate || '';
            
            updateNavigationButtons(index);
        }

        function updateNavigationButtons(index) {
            prevBtn.disabled = (index === 0);
            
            if (index === questions.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'block';
            } else {
                nextBtn.style.display = 'block';
                submitBtn.style.display = 'none';
                nextBtn.disabled = false;
            }
        }

        function changeQuestion(direction) {
            saveCurrentAnswer();

            currentQuestionIndex += direction;
            loadQuestion(currentQuestionIndex);
        }

        // æäº¤æ¸¬é©—ä¸¦è¨ˆåˆ†
        function submitQuiz() {
            saveCurrentAnswer();
            
            quizSection.style.display = 'none';
            resultArea.style.display = 'block';
            document.getElementById('final-name').textContent = studentName;

            let totalRawScore = 0;
            const tolerance = 0.01; 
            const MAX_RAW_SCORE = questions.length * 10; // 8 é¡Œ * 10 åˆ†/é¡Œ = 80 åˆ†

            quizAnswers.forEach(stuAns => {
                const q = stuAns.ans; 
                let score = 0;
                
                const ansDist = Math.round(q.ansDist * 100) / 100;
                const ansTime = Math.round(q.ansTime * 100) / 100;
                const ansRate = Math.round(q.ansRate * 100) / 100;
                
                // è¨ˆåˆ†ï¼šç¸½è·é›¢(3åˆ†) + ç¸½æ™‚é–“(3åˆ†) + å¹³å‡é€Ÿç‡(4åˆ†) = 10åˆ†
                if (Math.abs(stuAns.dist - ansDist) < tolerance) { score += 3; }
                if (Math.abs(stuAns.time - ansTime) < tolerance) { score += 3; }
                if (Math.abs(stuAns.rate - ansRate) < tolerance) { score += 4; }
                
                totalRawScore += score;
            });
            
            let finalScaledScore = (totalRawScore / MAX_RAW_SCORE) * 100;
            finalScaledScore = Math.round(finalScaledScore * 100) / 100; 

            finalScoreEl.textContent = `${finalScaledScore} åˆ†`;
        }
    </script>
</body>
</html>
